package ru.yappy.docstorage.util;

import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.*;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.*;

public class ExploitValidatorTest {

    @ParameterizedTest
    @ValueSource(strings = { "Простая строка", "\r", "", "Чуть-чуть опасная строка drop" })
    @NullSource
    void validateStrings_whenGetStringsWithoutDangerousWordsOrNull_thenMakeNoExceptions(String string) {
        assertDoesNotThrow(() -> ExploitValidator.validateStrings(string));
    }

    @ParameterizedTest
    @ValueSource(strings = { "Простая строка <script>", "\r drop ", "/src/*/resoursce", "Moscow -- Beijing" })
    void validateStrings_whenGetDangerousString_thenThrowsIllegalArgumentException(String string) {
        IllegalArgumentException exception = assertThrows(IllegalArgumentException.class,
                () -> ExploitValidator.validateStrings(string));
        assertThat(exception.getMessage()).startsWith("С целью обеспечения безопасности не допускается использование ");
    }

}