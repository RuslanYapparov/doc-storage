package ru.yappy.docstorage.util;

import lombok.experimental.UtilityClass;

@UtilityClass
public class ExploitValidator {

    private static final String[] DANGEROUS_KEYWORDS = new String[]{
            "<script>", "</script>", "javascript:", "<iframe>", "</iframe>",
            "onload=", "onerror=", "alert(", "select ", "insert ", "update ", "delete ",
            "drop ", "truncate ", "--", ";--", "/*", "*/", "xp_", "' or '1'='1",
            "<img", "document.cookie", "eval(", "base64,", "union ", "exec(", "char(",
            "cast(", "declare"
    };

    public static void validateStrings(String... inputs) {
        if (inputs == null) {
            return;
        }

        for (String input : inputs) {
            if (input != null) {
                String lowerCaseInput = input.toLowerCase();

                for (String keyword : DANGEROUS_KEYWORDS) {
                    if (lowerCaseInput.contains(keyword)) {
                        throw new IllegalArgumentException("С целью обеспечения безопасности не допускается " +
                                "использование выражения '" + keyword + "' при сохранении объектов.");
                    }
                }
            }
        }
    }

}